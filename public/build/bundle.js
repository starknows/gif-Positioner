var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function s(t){t.forEach(e)}function i(t){return"function"==typeof t}function r(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let a,o;function l(t,e){return a||(a=document.createElement("a")),a.href=e,t===a.href}function h(t,e){t.appendChild(e)}function c(t,e,n){t.insertBefore(e,n||null)}function d(t){t.parentNode&&t.parentNode.removeChild(t)}function f(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function u(t){return document.createElement(t)}function p(){return t=" ",document.createTextNode(t);var t}function m(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function g(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function v(t,e,n){e in t?t[e]="boolean"==typeof t[e]&&""===n||n:g(t,e,n)}function _(t){o=t}const y=[],b=[],x=[],w=[],k=Promise.resolve();let $=!1;function E(t){x.push(t)}const B=new Set;let C=0;function L(){const t=o;do{for(;C<y.length;){const t=y[C];C++,_(t),A(t.$$)}for(_(null),y.length=0,C=0;b.length;)b.pop()();for(let t=0;t<x.length;t+=1){const e=x[t];B.has(e)||(B.add(e),e())}x.length=0}while(y.length);for(;w.length;)w.pop()();$=!1,B.clear(),_(t)}function A(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(E)}}const F=new Set;function P(t,e){-1===t.$$.dirty[0]&&(y.push(t),$||($=!0,k.then(L)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function I(r,a,l,h,c,f,u,p=[-1]){const m=o;_(r);const g=r.$$={fragment:null,ctx:[],props:f,update:t,not_equal:c,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(a.context||(m?m.$$.context:[])),callbacks:n(),dirty:p,skip_bound:!1,root:a.target||m.$$.root};u&&u(g.root);let v=!1;if(g.ctx=l?l(r,a.props||{},((t,e,...n)=>{const s=n.length?n[0]:e;return g.ctx&&c(g.ctx[t],g.ctx[t]=s)&&(!g.skip_bound&&g.bound[t]&&g.bound[t](s),v&&P(r,t)),e})):[],g.update(),v=!0,s(g.before_update),g.fragment=!!h&&h(g.ctx),a.target){if(a.hydrate){const t=function(t){return Array.from(t.childNodes)}(a.target);g.fragment&&g.fragment.l(t),t.forEach(d)}else g.fragment&&g.fragment.c();a.intro&&((y=r.$$.fragment)&&y.i&&(F.delete(y),y.i(b))),function(t,n,r,a){const{fragment:o,after_update:l}=t.$$;o&&o.m(n,r),a||E((()=>{const n=t.$$.on_mount.map(e).filter(i);t.$$.on_destroy?t.$$.on_destroy.push(...n):s(n),t.$$.on_mount=[]})),l.forEach(E)}(r,a.target,a.anchor,a.customElement),L()}var y,b;_(m)}class H{$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=t}$on(e,n){if(!i(n))return t;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(n),()=>{const t=s.indexOf(n);-1!==t&&s.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function M(t,e,n){const s=t.slice();return s[22]=e[n],s[24]=n,s}function W(t,e,n){const s=t.slice();return s[22]=e[n],s[24]=n,s}function z(t){let e,n,i,r,a,o,l,v,_,y,b,x=t[2],w=[];for(let e=0;e<x.length;e+=1)w[e]=T(M(t,x,e));return{c(){e=u("div"),n=u("div"),i=p(),r=u("div"),a=p(),o=u("div"),l=p(),v=u("div"),_=p();for(let t=0;t<w.length;t+=1)w[t].c();g(n,"class","back-to-setting left top svelte-1h4f57n"),g(r,"class","back-to-setting left bottom svelte-1h4f57n"),g(o,"class","back-to-setting right top svelte-1h4f57n"),g(v,"class","back-to-setting right bottom svelte-1h4f57n"),g(e,"class","stage-wrapper svelte-1h4f57n")},m(s,d){c(s,e,d),h(e,n),h(e,i),h(e,r),h(e,a),h(e,o),h(e,l),h(e,v),h(e,_);for(let t=0;t<w.length;t+=1)w[t].m(e,null);y||(b=[m(n,"click",t[14]),m(n,"keypress",t[15]),m(r,"click",t[16]),m(r,"keypress",t[17]),m(o,"click",t[18]),m(o,"keypress",t[19]),m(v,"click",t[20]),m(v,"keypress",t[21])],y=!0)},p(t,n){if(13&n){let s;for(x=t[2],s=0;s<x.length;s+=1){const i=M(t,x,s);w[s]?w[s].p(i,n):(w[s]=T(i),w[s].c(),w[s].m(e,null))}for(;s<w.length;s+=1)w[s].d(1);w.length=x.length}},d(t){t&&d(e),f(w,t),y=!1,s(b)}}}function S(t){let e,n,i,r,a,o,v,_,y,b,x,w,k,$,E,B,C,L,A,F,P,I,H,M,z,S,T,G,N,U,O,R,j,D,X=t[2],J=[];for(let e=0;e<X.length;e+=1)J[e]=q(W(t,X,e));return{c(){e=u("div"),n=u("div"),i=u("h3"),i.textContent="選擇圖片",r=p(),a=u("input"),o=p(),v=u("div"),_=u("p"),_.textContent="預覽圖：",y=p(),b=u("img"),w=p(),k=u("div"),$=u("div"),E=u("label"),E.textContent="BPM：",B=p(),C=u("input"),L=p(),A=u("button"),A.innerHTML='<span class="button-82-shadow"></span> \n          <span class="button-82-edge"></span> \n          <span class="button-82-front text">開始你的表演</span>',F=p(),P=u("span"),P.textContent="tip: 表演狀態時，點擊畫面四角即可返回",I=p(),H=u("span"),H.textContent="tip2: 建議使用 1秒1完整動作 的GIF",M=p(),z=u("div"),z.innerHTML="<p>Author: starknows</p> \n        <p>Email: starknows99@gmail.com</p>",S=p(),T=u("div"),G=u("div"),N=u("button"),N.textContent="新增區塊",U=p(),O=u("button"),O.textContent="清除區塊",R=p();for(let t=0;t<J.length;t+=1)J[t].c();g(i,"class","svelte-1h4f57n"),g(a,"type","file"),g(a,"accept","image/gif"),g(a,"class","svelte-1h4f57n"),l(b.src,x=t[0])||g(b,"src",x),g(b,"alt",""),g(b,"class","svelte-1h4f57n"),g(v,"class","contror-preview flex-center svelte-1h4f57n"),g(n,"class","control-area card flex-center flex-col svelte-1h4f57n"),g(E,"for","input-bpm"),g(C,"id","input-bpm"),g(C,"type","number"),C.value=t[3],g(C,"min","60"),g(C,"max","240"),g(C,"class","svelte-1h4f57n"),g($,"class","bpm-wrapper flex-center svelte-1h4f57n"),g(A,"class","button-82-pushable"),g(P,"class","svelte-1h4f57n"),g(H,"class","svelte-1h4f57n"),g(k,"class","button-wrapper card flex-center flex-col svelte-1h4f57n"),g(z,"class","author-wrapper card flex-center flex-col svelte-1h4f57n"),g(e,"class","control-wrapper flex-center flex-col space-between svelte-1h4f57n"),g(N,"class","svelte-1h4f57n"),g(O,"class","svelte-1h4f57n"),g(G,"class","add-item flex-center svelte-1h4f57n"),g(T,"class","layout-setting card svelte-1h4f57n")},m(s,l){c(s,e,l),h(e,n),h(n,i),h(n,r),h(n,a),h(n,o),h(n,v),h(v,_),h(v,y),h(v,b),h(e,w),h(e,k),h(k,$),h($,E),h($,B),h($,C),h(k,L),h(k,A),h(k,F),h(k,P),h(k,I),h(k,H),h(e,M),h(e,z),c(s,S,l),c(s,T,l),h(T,G),h(G,N),h(G,U),h(G,O),h(T,R);for(let t=0;t<J.length;t+=1)J[t].m(T,null);j||(D=[m(a,"change",t[4]),m(C,"input",t[9]),m(A,"click",t[8]),m(N,"click",t[5]),m(O,"click",t[10])],j=!0)},p(t,e){if(1&e&&!l(b.src,x=t[0])&&g(b,"src",x),8&e&&C.value!==t[3]&&(C.value=t[3]),196&e){let n;for(X=t[2],n=0;n<X.length;n+=1){const s=W(t,X,n);J[n]?J[n].p(s,e):(J[n]=q(s),J[n].c(),J[n].m(T,null))}for(;n<J.length;n+=1)J[n].d(1);J.length=X.length}},d(t){t&&d(e),t&&d(S),t&&d(T),f(J,t),j=!1,s(D)}}}function T(t){let e,n,s,i,r,a;return{c(){e=u("div"),n=u("gif-player"),r=p(),l(n.src,s=t[0])||v(n,"src",s),v(n,"speed",i=t[3]/60),v(n,"play",""),v(n,"class","svelte-1h4f57n"),g(e,"class","render-unit svelte-1h4f57n"),g(e,"style",a=`width:${t[22].width}px;height:${t[22].height}px;left:${t[22].left}%;top:${t[22].top}%;`)},m(t,s){c(t,e,s),h(e,n),h(e,r)},p(t,r){1&r&&!l(n.src,s=t[0])&&v(n,"src",s),8&r&&i!==(i=t[3]/60)&&v(n,"speed",i),4&r&&a!==(a=`width:${t[22].width}px;height:${t[22].height}px;left:${t[22].left}%;top:${t[22].top}%;`)&&g(e,"style",a)},d(t){t&&d(e)}}}function q(t){let e,n,i,r,a,o,l,f,v,_,y;function b(...e){return t[11](t[24],...e)}function x(...e){return t[12](t[24],...e)}function w(...e){return t[13](t[24],...e)}return{c(){e=u("div"),n=u("span"),n.textContent="close",i=p(),r=u("div"),a=u("span"),a.textContent="add",o=p(),l=u("span"),l.textContent="remove",f=p(),g(n,"class","material-symbols-outlined icon-close svelte-1h4f57n"),g(a,"class","material-symbols-outlined svelte-1h4f57n"),g(l,"class","material-symbols-outlined svelte-1h4f57n"),g(r,"class","scale-icon-wrapper flex-center flex-col svelte-1h4f57n"),g(e,"class","item-unit svelte-1h4f57n"),g(e,"style",v=`width:${t[22].width}px;height:${t[22].height}px;left:${t[22].left}%;top:${t[22].top}%;`),g(e,"data-index",t[24])},m(s,d){c(s,e,d),h(e,n),h(e,i),h(e,r),h(r,a),h(r,o),h(r,l),h(e,f),_||(y=[m(n,"click",b),m(a,"click",x),m(l,"click",w),m(e,"mousedown",t[6])],_=!0)},p(n,s){t=n,4&s&&v!==(v=`width:${t[22].width}px;height:${t[22].height}px;left:${t[22].left}%;top:${t[22].top}%;`)&&g(e,"style",v)},d(t){t&&d(e),_=!1,s(y)}}}function G(e){let n;function s(t,e){return t[1]?z:S}let i=s(e),r=i(e);return{c(){n=u("main"),r.c(),g(n,"class","flex-center svelte-1h4f57n")},m(t,e){c(t,n,e),r.m(n,null)},p(t,[e]){i===(i=s(t))&&r?r.p(t,e):(r.d(1),r=i(t),r&&(r.c(),r.m(n,null)))},i:t,o:t,d(t){t&&d(n),r.d()}}}function N(t,e,n){let s=null,i=!1,r=[],a=60;function o(t,e,s){switch(console.log(e,s),t.stopPropagation(),e){case"plus":n(2,r[s].width+=20,r),n(2,r[s].height+=20,r),r[s].width>800&&n(2,r[s].width=800,r),r[s].height>800&&n(2,r[s].height=800,r);break;case"minus":n(2,r[s].width-=20,r),n(2,r[s].height-=20,r),r[s].width<100&&n(2,r[s].width=100,r),r[s].height<100&&n(2,r[s].height=100,r);break;case"remove":console.log("trigger"),r.splice(s,1),n(2,r=[...r])}}return[s,i,r,a,function(t){const[e]=t.target.files;e&&(n(0,s=URL.createObjectURL(e)),console.log(s))},function(){console.log("trigger"),n(2,r=[...r,{top:0,left:0,width:100,height:100,layer:null}])},function(t){t.stopPropagation();let e=t.target.dataset.index;if(!e)return;const s=t.target.parentElement.clientWidth,i=t.target.parentElement.clientHeight,a=JSON.parse(JSON.stringify(r[e])),o=a.left,l=a.top,h=t.clientX,c=t.clientY,d=Math.floor(a.width/s*1e3)/10,f=Math.floor(a.height/i*1e3)/10;document.onmousemove=t=>{const a=Math.floor((t.clientX-h)/s*1e3)/10,u=Math.floor((t.clientY-c)/i*1e3)/10;n(2,r[e].left=o+a,r),n(2,r[e].top=l+u,r),r[e].left+d>100&&n(2,r[e].left=100-d,r),r[e].left<0&&n(2,r[e].left=0,r),r[e].top+f>100&&n(2,r[e].top=100-f,r),r[e].top<0&&n(2,r[e].top=0,r)};let u=()=>{document.onmousemove=null,document.removeEventListener("mouseup",u)};document.addEventListener("mouseup",u)},o,function(){s?r.length<1?alert("請新增GIF區塊!"):n(1,i=!0):alert("請上傳GIF!")},t=>n(3,a=t.target.value),()=>n(2,r=[]),(t,e)=>o(e,"remove",t),(t,e)=>o(e,"plus",t),(t,e)=>o(e,"minus",t),()=>n(1,i=!1),()=>n(1,i=!1),()=>n(1,i=!1),()=>n(1,i=!1),()=>n(1,i=!1),()=>n(1,i=!1),()=>n(1,i=!1),()=>n(1,i=!1)]}function U(t){var e=0;if(71!==t[e++]||73!==t[e++]||70!==t[e++]||56!==t[e++]||56!=(t[e++]+1&253)||97!==t[e++])throw"Invalid GIF 87a/89a header.";var n=t[e++]|t[e++]<<8,s=t[e++]|t[e++]<<8,i=t[e++],r=i>>7,a=1<<(7&i)+1;t[e++],t[e++];var o=null;r&&(o=e,e+=3*a);var l=!0,h=[],c=0,d=null,f=0,u=null;for(this.width=n,this.height=s;l&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(11!==t[e]||78==t[e+1]&&69==t[e+2]&&84==t[e+3]&&83==t[e+4]&&67==t[e+5]&&65==t[e+6]&&80==t[e+7]&&69==t[e+8]&&50==t[e+9]&&46==t[e+10]&&48==t[e+11]&&3==t[e+12]&&1==t[e+13]&&0==t[e+16])e+=14,u=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(0===($=t[e++]))break;e+=$}break;case 249:if(4!==t[e++]||0!==t[e+4])throw"Invalid graphics extension block.";var p=t[e++];c=t[e++]|t[e++]<<8,d=t[e++],0==(1&p)&&(d=null),f=p>>2&7,e++;break;case 254:for(;;){if(0===($=t[e++]))break;e+=$}break;default:throw"Unknown graphic control label: 0x"+t[e-1].toString(16)}break;case 44:var m=t[e++]|t[e++]<<8,g=t[e++]|t[e++]<<8,v=t[e++]|t[e++]<<8,_=t[e++]|t[e++]<<8,y=t[e++],b=y>>6&1,x=o,w=!1;if(y>>7){w=!0;x=e,e+=3*(1<<(7&y)+1)}var k=e;for(e++;;){var $;if(0===($=t[e++]))break;e+=$}h.push({x:m,y:g,width:v,height:_,has_local_palette:w,palette_offset:x,data_offset:k,data_length:e-k,transparent_index:d,interlaced:!!b,delay:c,disposal:f});break;case 59:l=!1;break;default:throw"Unknown gif block: 0x"+t[e-1].toString(16)}this.numFrames=function(){return h.length},this.loopCount=function(){return u},this.frameInfo=function(t){if(t<0||t>=h.length)throw"Frame index out of range.";return h[t]},this.decodeAndBlitFrameRGBA=function(e,s){var i=this.frameInfo(e),r=i.width*i.height,a=new Uint8Array(r);!function(t,e,n,s){var i=t[e++],r=1<<i,a=r+1,o=a+1,l=i+1,h=(1<<l)-1,c=0,d=0,f=0,u=t[e++],p=new Int32Array(4096),m=null;for(;;){for(;c<16&&0!==u;)d|=t[e++]<<c,c+=8,1===u?u=t[e++]:--u;if(c<l)break;var g=d&h;if(d>>=l,c-=l,g!==r){if(g===a)break;for(var v=g<o?g:m,_=0,y=v;y>r;)y=p[y]>>8,++_;var b=y;if(f+_+(v!==g?1:0)>s)return void console.log("Warning, gif stream longer than expected.");n[f++]=b;var x=f+=_;for(v!==g&&(n[f++]=b),y=v;_--;)y=p[y],n[--x]=255&y,y>>=8;null!==m&&o<4096&&(p[o++]=m<<8|b,o>=h+1&&l<12&&(++l,h=h<<1|1)),m=g}else o=a+1,h=(1<<(l=i+1))-1,m=null}f!==s&&console.log("Warning, gif stream shorter than expected.")}(t,i.data_offset,a,r);var o=i.palette_offset,l=i.transparent_index;null===l&&(l=256);var h=i.width,c=n-h,d=h,f=4*(i.y*n+i.x),u=4*((i.y+i.height)*n+i.x),p=f,m=4*c;!0===i.interlaced&&(m+=4*n*7);for(var g=8,v=0,_=a.length;v<_;++v){var y=a[v];if(0===d&&(d=h,(p+=m)>=u&&(m=4*c+4*n*(g-1),p=f+(h+c)*(g<<1),g>>=1)),y===l)p+=4;else{var b=t[o+3*y],x=t[o+3*y+1],w=t[o+3*y+2];s[p++]=b,s[p++]=x,s[p++]=w,s[p++]=255}--d}}}!function(){const t=document.createElement("template");t.innerHTML="\n<style>\n  canvas {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n  }\n\n  @keyframes spinner {\n    to {transform: rotate(360deg);}\n  }\n\n  .spinner:before {\n    content: '';\n    box-sizing: border-box;\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    width: 20px;\n    height: 20px;\n    margin-top: -10px;\n    margin-left: -10px;\n    border-radius: 50%;\n    border-top: 2px solid #999;\n    border-right: 2px solid transparent;\n    animation: spinner .6s linear infinite;\n  }\n</style>\n<canvas></canvas>\n<div class=\"spinner\"></spinner>\n";class e extends HTMLElement{static get observedAttributes(){return["src","frame","size","speed","play","swipe","repeat","bounce","direction"]}constructor(){super(),this._speed=.5,this._size="auto",this._swipe=!0,this._repeat=!0,this._bounce=!1,this._prerender=!1,this._direction=1,this._reset(),this.pausePlaybackBound=this.pausePlayback.bind(this),this.moveBound=this.move.bind(this),this.resumePlaybackBound=this.resumePlayback.bind(this),this.prerenderFramesBound=this.prerenderFrames.bind(this),this.playLoopBound=this.playLoop.bind(this);const e=this.attachShadow({mode:"open"});e.appendChild(document.importNode(t.content,!0)),this._spinner=e.querySelector(".spinner"),this._canvas=e.querySelector("canvas"),this._ctx=this._canvas.getContext("2d")}connectedCallback(){this.style.display="inline-block",this.style.position="relative",this.style.overflow="hidden",this.style.cursor="col-resize",this.addEventListener("touchstart",this.pausePlaybackBound,!1),this.addEventListener("touchmove",this.moveBound,!1),this.addEventListener("touchend",this.resumePlaybackBound,!1),this.addEventListener("mouseenter",this.pausePlaybackBound,!1),this.addEventListener("mousemove",this.moveBound,!1),this.addEventListener("mouseleave",this.resumePlaybackBound,!1)}disconnectedCallback(){this.removeEventListener("touchstart",this.pausePlaybackBound,!1),this.removeEventListener("touchmove",this.moveBound,!1),this.removeEventListener("touchend",this.resumePlaybackBound,!1),this.removeEventListener("mouseenter",this.pausePlaybackBound,!1),this.removeEventListener("mousemove",this.moveBound,!1),this.removeEventListener("mouseleave",this.resumePlaybackBound,!1)}attributeChangedCallback(t,e,n){e!==n&&(this[t]=n)}_reset(){this._frames=[],this._delays=[],this._frame=0,this._decoded=-1,this._rendered=-1}_handleBoolean(t,e){this["_"+t]=e=null!=e,e?this.setAttribute(t,""):this.removeAttribute(t)}get src(){return this._src}set src(t){this._src=t,this.load(t)}get frame(){return this._frame}set frame(t){this._frame=parseInt(t),this.displayFrame(this._frames,this._frame)}get size(){return this._size}set size(t){this._size=t}get speed(){return this._speed}set speed(t){this._speed=parseFloat(t)}get swipe(){return this._swipe}set swipe(t){this._swipe=t}get play(){return this._play}set play(t){this._handleBoolean("play",t)}get repeat(){return this._repeat}set repeat(t){this._repeat=parseFloat(t)}get bounce(){return this._bounce}set bounce(t){this._handleBoolean("bounce",t)}get direction(){return this._direction}set direction(t){this._direction=parseInt(t)}get prerender(){return this._prerender}set prerender(t){this._prerender=t}get onload(){return this._onload}set onload(t){this._onload=t}move(t){var e;t.preventDefault(),e=t.targetTouches?t.targetTouches[0].clientX:t.clientX;var n=this.getBoundingClientRect(),s=(e-n.left)/n.width;this.frame=Math.round((this._frames.length-1)*s)}load(t){this._reset(),this.dispatchEvent(new CustomEvent("gif-loading",{bubbles:!0,composed:!0,detail:t})),this._spinner.style.display="block";fetch(t,{method:"GET",mode:"cors",cache:"default"}).then((t=>t.arrayBuffer())).then((t=>new Uint8Array(t))).then((t=>new U(t))).then((t=>this.process(t))).then((()=>this._spinner.style.display="none"))}process(t){this._gif=t,this._canvas.width=t.width,this._canvas.height=t.height;var e=t.width/t.height,n=this.clientWidth/this.clientHeight;switch(this._canvas.style.top=0,this._canvas.style.left=0,this._size){case"auto":this.style.width=t.width+"px",this.style.height=t.height+"px";break;case"cover":e>n?(s=this.clientHeight*e,i=this.clientHeight,this._canvas.style.top=0,this._canvas.style.left=-(s-this.clientWidth)/2+"px"):(s=this.clientWidth,i=this.clientWidth/e,this._canvas.style.top=-(i-this.clientHeight)/2+"px",this._canvas.style.left=0),this._canvas.style.width=s+"px",this._canvas.style.height=i+"px";break;case"contain":var s,i;e>n?(s=this.clientWidth,i=this.clientWidth/e,this._canvas.style.top=(this.clientHeight-i)/2+"px",this._canvas.style.left=0):(s=this.clientHeight*e,i=this.clientHeight,this._canvas.style.top=0,this._canvas.style.left=(this.clientWidth-s)/2+"px"),this._canvas.style.width=s+"px",this._canvas.style.height=i+"px";break;case"stretch":this._canvas.style.width="100%",this._canvas.style.height="100%"}var r=t.numFrames();this._decoded=-1,this._delays=new Array(r),this._frames=new Array(r),this._frame<0&&(this._frame=this._frames.length+this._frame);var a=new CustomEvent("gif-loaded",{bubbles:!0,composed:!0,detail:t});this.dispatchEvent(a),this._onload&&this._onload(a),this._play?this.start():this.displayFrame(this._frames,this._frame),this._prerender&&requestIdleCallback(this.prerenderFramesBound)}start(){this.playing=!0,this.playAnimation(this._frames,this._frame)}stop(){this.playing=!1}pausePlayback(t){this.paused=!0}resumePlayback(t){this.paused=!1,this.playing&&this.playAnimation(this._frames,this._frame)}playLoop(t){this.rafHandle=requestAnimationFrame(this.playLoopBound),this._rendered!=this._frame&&this._frames[this._frame]&&(this._rendered=this._frame,this._ctx.putImageData(this._frames[this._frame],0,0))}playAnimation(t,e){0!==t.length&&(this.renderFrame(e),setTimeout((()=>{if(!this.paused){var t=this.frame+this._direction;t<0?this._bounce?(this._direction=1,t=1):t=this._frames.length-1:t>=this._frames.length&&(this._bounce?(this._direction=-1,t=this._frames.length-2):t=0),this.frame=t,this.playAnimation(this._frames,this._frame)}}),this._delays[e]*(1/this._speed)))}next(){this.frame++,this.frame>=this._frames.length&&(this.frame=0),this.render(this.frame)}displayFrame(t,e){0!==t.length&&(e>=t.length&&(e=t.length-1),e<0&&(e+=t.length),this.renderFrame(e),this._rendered!=e&&requestAnimationFrame((()=>{this._ctx.putImageData(this._frames[e],0,0),this._rendered=e,this.dispatchEvent(new CustomEvent("gif-frame",{bubbles:!0,composed:!0,detail:e}))})))}renderFrame(t){for(;this._decoded<t;){var e=this._decoded+1,n=this._gif.frameInfo(e),s=this._ctx.createImageData(this._gif.width,this._gif.height);e>0&&n.disposal<2&&s.data.set(new Uint8ClampedArray(this._frames[e-1].data)),this._gif.decodeAndBlitFrameRGBA(e,s.data),this._frames[e]=s,this._delays[e]=10*n.delay,this._decoded=e}}prerenderFrames(t){for(;t.timeRemaining()>0&&this._decoded<this._frames.length-1;)this.renderFrame(this._decoded+1);this._decoded<this._frames.length-1&&requestIdleCallback(this.prerenderBound)}}console.log("trigger player"),window.customElements.define("gif-player",e)}();return new class extends H{constructor(t){super(),I(this,t,N,G,r,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
