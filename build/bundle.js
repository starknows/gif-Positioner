var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function s(t){t.forEach(e)}function i(t){return"function"==typeof t}function r(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let a,l;function o(t,e){return a||(a=document.createElement("a")),a.href=e,t===a.href}function h(t){return null==t?"":t}function c(t,e){t.appendChild(e)}function d(t,e,n){t.insertBefore(e,n||null)}function u(t){t.parentNode&&t.parentNode.removeChild(t)}function f(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function p(t){return document.createElement(t)}function m(){return t=" ",document.createTextNode(t);var t}function g(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function v(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function b(t,e,n){e in t?t[e]="boolean"==typeof t[e]&&""===n||n:v(t,e,n)}function _(t){l=t}const y=[],x=[],w=[],k=[],$=Promise.resolve();let E=!1;function F(t){w.push(t)}const B=new Set;let C=0;function L(){const t=l;do{for(;C<y.length;){const t=y[C];C++,_(t),A(t.$$)}for(_(null),y.length=0,C=0;x.length;)x.pop()();for(let t=0;t<w.length;t+=1){const e=w[t];B.has(e)||(B.add(e),e())}w.length=0}while(y.length);for(;k.length;)k.pop()();E=!1,B.clear(),_(t)}function A(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(F)}}const I=new Set;function P(t,e){-1===t.$$.dirty[0]&&(y.push(t),E||(E=!0,$.then(L)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function q(r,a,o,h,c,d,f,p=[-1]){const m=l;_(r);const g=r.$$={fragment:null,ctx:[],props:d,update:t,not_equal:c,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(a.context||(m?m.$$.context:[])),callbacks:n(),dirty:p,skip_bound:!1,root:a.target||m.$$.root};f&&f(g.root);let v=!1;if(g.ctx=o?o(r,a.props||{},((t,e,...n)=>{const s=n.length?n[0]:e;return g.ctx&&c(g.ctx[t],g.ctx[t]=s)&&(!g.skip_bound&&g.bound[t]&&g.bound[t](s),v&&P(r,t)),e})):[],g.update(),v=!0,s(g.before_update),g.fragment=!!h&&h(g.ctx),a.target){if(a.hydrate){const t=function(t){return Array.from(t.childNodes)}(a.target);g.fragment&&g.fragment.l(t),t.forEach(u)}else g.fragment&&g.fragment.c();a.intro&&((b=r.$$.fragment)&&b.i&&(I.delete(b),b.i(y))),function(t,n,r,a){const{fragment:l,after_update:o}=t.$$;l&&l.m(n,r),a||F((()=>{const n=t.$$.on_mount.map(e).filter(i);t.$$.on_destroy?t.$$.on_destroy.push(...n):s(n),t.$$.on_mount=[]})),o.forEach(F)}(r,a.target,a.anchor,a.customElement),L()}var b,y;_(m)}class H{$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=t}$on(e,n){if(!i(n))return t;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(n),()=>{const t=s.indexOf(n);-1!==t&&s.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function M(t,e,n){const s=t.slice();return s[24]=e[n],s[26]=n,s}function R(t,e,n){const s=t.slice();return s[24]=e[n],s[26]=n,s}function z(t){let e,n,i,r,a,l,o,h,b,_,y,x=t[2],w=[];for(let e=0;e<x.length;e+=1)w[e]=T(M(t,x,e));return{c(){e=p("div"),n=p("div"),i=m(),r=p("div"),a=m(),l=p("div"),o=m(),h=p("div"),b=m();for(let t=0;t<w.length;t+=1)w[t].c();v(n,"class","back-to-setting left top svelte-17f10tb"),v(r,"class","back-to-setting left bottom svelte-17f10tb"),v(l,"class","back-to-setting right top svelte-17f10tb"),v(h,"class","back-to-setting right bottom svelte-17f10tb"),v(e,"class","stage-wrapper svelte-17f10tb")},m(s,u){d(s,e,u),c(e,n),c(e,i),c(e,r),c(e,a),c(e,l),c(e,o),c(e,h),c(e,b);for(let t=0;t<w.length;t+=1)w[t].m(e,null);_||(y=[g(n,"click",t[16]),g(n,"keypress",t[17]),g(r,"click",t[18]),g(r,"keypress",t[19]),g(l,"click",t[20]),g(l,"keypress",t[21]),g(h,"click",t[22]),g(h,"keypress",t[23])],_=!0)},p(t,n){if(13&n){let s;for(x=t[2],s=0;s<x.length;s+=1){const i=M(t,x,s);w[s]?w[s].p(i,n):(w[s]=T(i),w[s].c(),w[s].m(e,null))}for(;s<w.length;s+=1)w[s].d(1);w.length=x.length}},d(t){t&&u(e),f(w,t),_=!1,s(y)}}}function S(t){let e,n,i,r,a,l,b,_,y,x,w,k,$,E,F,B,C,L,A,I,P,q,H,M,z,S,T,U,O,j,D,X,J,Y,K,Q,V;function Z(t,e){return t[4]?G:W}let tt=Z(t),et=tt(t),nt=t[2],st=[];for(let e=0;e<nt.length;e+=1)st[e]=N(R(t,nt,e));return{c(){e=p("div"),n=p("div"),i=p("h3"),i.textContent="選擇圖片",r=m(),a=p("input"),l=m(),b=p("div"),_=p("p"),_.textContent="預覽圖：",y=m(),x=p("img"),k=m(),$=p("div"),E=p("div"),F=p("label"),F.textContent="BPM：",B=m(),C=p("input"),L=m(),A=p("button"),A.innerHTML='<span class="button-82-shadow"></span> \n                    <span class="button-82-edge"></span> \n                    <span class="button-82-front text">開始你的表演</span>',I=m(),P=p("span"),P.textContent="tip: 表演狀態時，點擊畫面四角即可返回",q=m(),H=p("span"),H.textContent="tip2: 建議使用 1秒1完整動作 的GIF",M=m(),z=p("div"),z.innerHTML="<p>Author: starknows</p> \n                <p>Email: starknows99@gmail.com</p>",S=m(),T=p("div"),U=p("div"),O=p("button"),O.innerHTML='<span class="material-symbols-outlined">library_add</span> 新增區塊',j=m(),D=p("button"),D.innerHTML='<span class="material-symbols-outlined">delete</span> 清除區塊',X=m(),J=p("button"),et.c(),Y=m();for(let t=0;t<st.length;t+=1)st[t].c();v(i,"class","svelte-17f10tb"),v(a,"type","file"),v(a,"accept","image/gif"),v(a,"class","svelte-17f10tb"),o(x.src,w=t[0])||v(x,"src",w),v(x,"alt",""),v(x,"class","svelte-17f10tb"),v(b,"class","contror-preview flex-center svelte-17f10tb"),v(n,"class","control-area card flex-center flex-col svelte-17f10tb"),v(F,"for","input-bpm"),v(C,"id","input-bpm"),v(C,"type","number"),C.value=t[3],v(C,"min","60"),v(C,"max","240"),v(C,"class","svelte-17f10tb"),v(E,"class","bpm-wrapper flex-center svelte-17f10tb"),v(A,"class","button-82-pushable svelte-17f10tb"),v(P,"class","svelte-17f10tb"),v(H,"class","svelte-17f10tb"),v($,"class","button-wrapper card flex-center flex-col svelte-17f10tb"),v(z,"class","author-wrapper card flex-center flex-col svelte-17f10tb"),v(e,"class","control-wrapper flex-center flex-col space-between svelte-17f10tb"),v(O,"class","flex-center svelte-17f10tb"),v(D,"class","flex-center svelte-17f10tb"),v(J,"class","flex-center svelte-17f10tb"),v(U,"class","add-item flex-center svelte-17f10tb"),v(T,"id","setting-wrapper"),v(T,"class",K=h("layout-setting "+(t[4]?"preview":"card"))+" svelte-17f10tb")},m(s,o){d(s,e,o),c(e,n),c(n,i),c(n,r),c(n,a),c(n,l),c(n,b),c(b,_),c(b,y),c(b,x),c(e,k),c(e,$),c($,E),c(E,F),c(E,B),c(E,C),c($,L),c($,A),c($,I),c($,P),c($,q),c($,H),c(e,M),c(e,z),d(s,S,o),d(s,T,o),c(T,U),c(U,O),c(U,j),c(U,D),c(U,X),c(U,J),et.m(J,null),c(T,Y);for(let t=0;t<st.length;t+=1)st[t].m(T,null);Q||(V=[g(a,"change",t[5]),g(C,"input",t[11]),g(A,"click",t[9]),g(O,"click",t[6]),g(D,"click",t[12]),g(J,"click",t[10])],Q=!0)},p(t,e){if(1&e&&!o(x.src,w=t[0])&&v(x,"src",w),8&e&&C.value!==t[3]&&(C.value=t[3]),tt!==(tt=Z(t))&&(et.d(1),et=tt(t),et&&(et.c(),et.m(J,null))),388&e){let n;for(nt=t[2],n=0;n<nt.length;n+=1){const s=R(t,nt,n);st[n]?st[n].p(s,e):(st[n]=N(s),st[n].c(),st[n].m(T,null))}for(;n<st.length;n+=1)st[n].d(1);st.length=nt.length}16&e&&K!==(K=h("layout-setting "+(t[4]?"preview":"card"))+" svelte-17f10tb")&&v(T,"class",K)},d(t){t&&u(e),t&&u(S),t&&u(T),et.d(),f(st,t),Q=!1,s(V)}}}function T(t){let e,n,s,i,r,a;return{c(){e=p("div"),n=p("gif-player"),r=m(),o(n.src,s=t[0])||b(n,"src",s),b(n,"speed",i=t[3]/60),b(n,"play",""),b(n,"class","svelte-17f10tb"),v(e,"class","render-unit svelte-17f10tb"),v(e,"style",a=`width:${t[24].width}px;height:${t[24].height}px;left:${t[24].left}%;top:${t[24].top}%;`)},m(t,s){d(t,e,s),c(e,n),c(e,r)},p(t,r){1&r&&!o(n.src,s=t[0])&&b(n,"src",s),8&r&&i!==(i=t[3]/60)&&b(n,"speed",i),4&r&&a!==(a=`width:${t[24].width}px;height:${t[24].height}px;left:${t[24].left}%;top:${t[24].top}%;`)&&v(e,"style",a)},d(t){t&&u(e)}}}function W(t){let e,n,s;return{c(){e=p("span"),e.textContent="open_with",n=m(),s=p("span"),s.textContent=" 全螢幕",v(e,"class","material-symbols-outlined")},m(t,i){d(t,e,i),d(t,n,i),d(t,s,i)},d(t){t&&u(e),t&&u(n),t&&u(s)}}}function G(t){let e,n,s;return{c(){e=p("span"),e.textContent="close_fullscreen",n=m(),s=p("span"),s.textContent=" 關閉",v(e,"class","material-symbols-outlined")},m(t,i){d(t,e,i),d(t,n,i),d(t,s,i)},d(t){t&&u(e),t&&u(n),t&&u(s)}}}function N(t){let e,n,i,r,a,l,o,h,f,b,_;function y(...e){return t[13](t[26],...e)}function x(...e){return t[14](t[26],...e)}function w(...e){return t[15](t[26],...e)}return{c(){e=p("div"),n=p("span"),n.textContent="close",i=m(),r=p("div"),a=p("span"),a.textContent="add",l=m(),o=p("span"),o.textContent="remove",h=m(),v(n,"class","material-symbols-outlined icon-close svelte-17f10tb"),v(a,"class","material-symbols-outlined svelte-17f10tb"),v(o,"class","material-symbols-outlined svelte-17f10tb"),v(r,"class","scale-icon-wrapper flex-center flex-col svelte-17f10tb"),v(e,"class","item-unit svelte-17f10tb"),v(e,"style",f=`width:${t[24].width}px;height:${t[24].height}px;left:${t[24].left}%;top:${t[24].top}%;`),v(e,"data-index",t[26])},m(s,u){d(s,e,u),c(e,n),c(e,i),c(e,r),c(r,a),c(r,l),c(r,o),c(e,h),b||(_=[g(n,"click",y),g(a,"click",x),g(o,"click",w),g(e,"mousedown",t[7])],b=!0)},p(n,s){t=n,4&s&&f!==(f=`width:${t[24].width}px;height:${t[24].height}px;left:${t[24].left}%;top:${t[24].top}%;`)&&v(e,"style",f)},d(t){t&&u(e),b=!1,s(_)}}}function U(e){let n;function s(t,e){return t[1]?z:S}let i=s(e),r=i(e);return{c(){n=p("main"),r.c(),v(n,"class","flex-center svelte-17f10tb")},m(t,e){d(t,n,e),r.m(n,null)},p(t,[e]){i===(i=s(t))&&r?r.p(t,e):(r.d(1),r=i(t),r&&(r.c(),r.m(n,null)))},i:t,o:t,d(t){t&&u(n),r.d()}}}function O(t,e,n){let s=null,i=!1,r=[],a=60,l=!1;function o(t,e,s){switch(console.log(e,s),t.stopPropagation(),e){case"plus":n(2,r[s].width+=20,r),n(2,r[s].height+=20,r),r[s].width>800&&n(2,r[s].width=800,r),r[s].height>800&&n(2,r[s].height=800,r);break;case"minus":n(2,r[s].width-=20,r),n(2,r[s].height-=20,r),r[s].width<100&&n(2,r[s].width=100,r),r[s].height<100&&n(2,r[s].height=100,r);break;case"remove":console.log("trigger"),r.splice(s,1),n(2,r=[...r])}}return[s,i,r,a,l,function(t){const[e]=t.target.files;e&&(n(0,s=URL.createObjectURL(e)),console.log(s))},function(){console.log("trigger"),n(2,r=[...r,{top:0,left:0,width:100,height:100,layer:null}])},function(t){t.stopPropagation();let e=t.target.dataset.index;if(!e)return;const s=t.target.parentElement.clientWidth,i=t.target.parentElement.clientHeight,a=JSON.parse(JSON.stringify(r[e])),l=a.left,o=a.top,h=t.clientX,c=t.clientY,d=Math.floor(a.width/s*1e3)/10,u=Math.floor(a.height/i*1e3)/10;document.onmousemove=t=>{const a=Math.floor((t.clientX-h)/s*1e3)/10,f=Math.floor((t.clientY-c)/i*1e3)/10;n(2,r[e].left=l+a,r),n(2,r[e].top=o+f,r),r[e].left+d>100&&n(2,r[e].left=100-d,r),r[e].left<0&&n(2,r[e].left=0,r),r[e].top+u>100&&n(2,r[e].top=100-u,r),r[e].top<0&&n(2,r[e].top=0,r)};let f=()=>{document.onmousemove=null,document.removeEventListener("mouseup",f)};document.addEventListener("mouseup",f)},o,function(){s?r.length<1?alert("請新增GIF區塊!"):n(1,i=!0):alert("請上傳GIF!")},function(){if(l)document.exitFullscreen();else{let t=document.getElementById("setting-wrapper");t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()}n(4,l=!l)},t=>n(3,a=t.target.value),()=>n(2,r=[]),(t,e)=>o(e,"remove",t),(t,e)=>o(e,"plus",t),(t,e)=>o(e,"minus",t),()=>n(1,i=!1),()=>n(1,i=!1),()=>n(1,i=!1),()=>n(1,i=!1),()=>n(1,i=!1),()=>n(1,i=!1),()=>n(1,i=!1),()=>n(1,i=!1)]}function j(t){var e=0;if(71!==t[e++]||73!==t[e++]||70!==t[e++]||56!==t[e++]||56!=(t[e++]+1&253)||97!==t[e++])throw"Invalid GIF 87a/89a header.";var n=t[e++]|t[e++]<<8,s=t[e++]|t[e++]<<8,i=t[e++],r=i>>7,a=1<<(7&i)+1;t[e++],t[e++];var l=null;r&&(l=e,e+=3*a);var o=!0,h=[],c=0,d=null,u=0,f=null;for(this.width=n,this.height=s;o&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(11!==t[e]||78==t[e+1]&&69==t[e+2]&&84==t[e+3]&&83==t[e+4]&&67==t[e+5]&&65==t[e+6]&&80==t[e+7]&&69==t[e+8]&&50==t[e+9]&&46==t[e+10]&&48==t[e+11]&&3==t[e+12]&&1==t[e+13]&&0==t[e+16])e+=14,f=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(0===($=t[e++]))break;e+=$}break;case 249:if(4!==t[e++]||0!==t[e+4])throw"Invalid graphics extension block.";var p=t[e++];c=t[e++]|t[e++]<<8,d=t[e++],0==(1&p)&&(d=null),u=p>>2&7,e++;break;case 254:for(;;){if(0===($=t[e++]))break;e+=$}break;default:throw"Unknown graphic control label: 0x"+t[e-1].toString(16)}break;case 44:var m=t[e++]|t[e++]<<8,g=t[e++]|t[e++]<<8,v=t[e++]|t[e++]<<8,b=t[e++]|t[e++]<<8,_=t[e++],y=_>>6&1,x=l,w=!1;if(_>>7){w=!0;x=e,e+=3*(1<<(7&_)+1)}var k=e;for(e++;;){var $;if(0===($=t[e++]))break;e+=$}h.push({x:m,y:g,width:v,height:b,has_local_palette:w,palette_offset:x,data_offset:k,data_length:e-k,transparent_index:d,interlaced:!!y,delay:c,disposal:u});break;case 59:o=!1;break;default:throw"Unknown gif block: 0x"+t[e-1].toString(16)}this.numFrames=function(){return h.length},this.loopCount=function(){return f},this.frameInfo=function(t){if(t<0||t>=h.length)throw"Frame index out of range.";return h[t]},this.decodeAndBlitFrameRGBA=function(e,s){var i=this.frameInfo(e),r=i.width*i.height,a=new Uint8Array(r);!function(t,e,n,s){var i=t[e++],r=1<<i,a=r+1,l=a+1,o=i+1,h=(1<<o)-1,c=0,d=0,u=0,f=t[e++],p=new Int32Array(4096),m=null;for(;;){for(;c<16&&0!==f;)d|=t[e++]<<c,c+=8,1===f?f=t[e++]:--f;if(c<o)break;var g=d&h;if(d>>=o,c-=o,g!==r){if(g===a)break;for(var v=g<l?g:m,b=0,_=v;_>r;)_=p[_]>>8,++b;var y=_;if(u+b+(v!==g?1:0)>s)return void console.log("Warning, gif stream longer than expected.");n[u++]=y;var x=u+=b;for(v!==g&&(n[u++]=y),_=v;b--;)_=p[_],n[--x]=255&_,_>>=8;null!==m&&l<4096&&(p[l++]=m<<8|y,l>=h+1&&o<12&&(++o,h=h<<1|1)),m=g}else l=a+1,h=(1<<(o=i+1))-1,m=null}u!==s&&console.log("Warning, gif stream shorter than expected.")}(t,i.data_offset,a,r);var l=i.palette_offset,o=i.transparent_index;null===o&&(o=256);var h=i.width,c=n-h,d=h,u=4*(i.y*n+i.x),f=4*((i.y+i.height)*n+i.x),p=u,m=4*c;!0===i.interlaced&&(m+=4*n*7);for(var g=8,v=0,b=a.length;v<b;++v){var _=a[v];if(0===d&&(d=h,(p+=m)>=f&&(m=4*c+4*n*(g-1),p=u+(h+c)*(g<<1),g>>=1)),_===o)p+=4;else{var y=t[l+3*_],x=t[l+3*_+1],w=t[l+3*_+2];s[p++]=y,s[p++]=x,s[p++]=w,s[p++]=255}--d}}}!function(){const t=document.createElement("template");t.innerHTML="\n<style>\n  canvas {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n  }\n\n  @keyframes spinner {\n    to {transform: rotate(360deg);}\n  }\n\n  .spinner:before {\n    content: '';\n    box-sizing: border-box;\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    width: 20px;\n    height: 20px;\n    margin-top: -10px;\n    margin-left: -10px;\n    border-radius: 50%;\n    border-top: 2px solid #999;\n    border-right: 2px solid transparent;\n    animation: spinner .6s linear infinite;\n  }\n</style>\n<canvas></canvas>\n<div class=\"spinner\"></spinner>\n";class e extends HTMLElement{static get observedAttributes(){return["src","frame","size","speed","play","swipe","repeat","bounce","direction"]}constructor(){super(),this._speed=.5,this._size="auto",this._swipe=!0,this._repeat=!0,this._bounce=!1,this._prerender=!1,this._direction=1,this._reset(),this.pausePlaybackBound=this.pausePlayback.bind(this),this.moveBound=this.move.bind(this),this.resumePlaybackBound=this.resumePlayback.bind(this),this.prerenderFramesBound=this.prerenderFrames.bind(this),this.playLoopBound=this.playLoop.bind(this);const e=this.attachShadow({mode:"open"});e.appendChild(document.importNode(t.content,!0)),this._spinner=e.querySelector(".spinner"),this._canvas=e.querySelector("canvas"),this._ctx=this._canvas.getContext("2d")}connectedCallback(){this.style.display="inline-block",this.style.position="relative",this.style.overflow="hidden",this.style.cursor="col-resize",this.addEventListener("touchstart",this.pausePlaybackBound,!1),this.addEventListener("touchmove",this.moveBound,!1),this.addEventListener("touchend",this.resumePlaybackBound,!1),this.addEventListener("mouseenter",this.pausePlaybackBound,!1),this.addEventListener("mousemove",this.moveBound,!1),this.addEventListener("mouseleave",this.resumePlaybackBound,!1)}disconnectedCallback(){this.removeEventListener("touchstart",this.pausePlaybackBound,!1),this.removeEventListener("touchmove",this.moveBound,!1),this.removeEventListener("touchend",this.resumePlaybackBound,!1),this.removeEventListener("mouseenter",this.pausePlaybackBound,!1),this.removeEventListener("mousemove",this.moveBound,!1),this.removeEventListener("mouseleave",this.resumePlaybackBound,!1)}attributeChangedCallback(t,e,n){e!==n&&(this[t]=n)}_reset(){this._frames=[],this._delays=[],this._frame=0,this._decoded=-1,this._rendered=-1}_handleBoolean(t,e){this["_"+t]=e=null!=e,e?this.setAttribute(t,""):this.removeAttribute(t)}get src(){return this._src}set src(t){this._src=t,this.load(t)}get frame(){return this._frame}set frame(t){this._frame=parseInt(t),this.displayFrame(this._frames,this._frame)}get size(){return this._size}set size(t){this._size=t}get speed(){return this._speed}set speed(t){this._speed=parseFloat(t)}get swipe(){return this._swipe}set swipe(t){this._swipe=t}get play(){return this._play}set play(t){this._handleBoolean("play",t)}get repeat(){return this._repeat}set repeat(t){this._repeat=parseFloat(t)}get bounce(){return this._bounce}set bounce(t){this._handleBoolean("bounce",t)}get direction(){return this._direction}set direction(t){this._direction=parseInt(t)}get prerender(){return this._prerender}set prerender(t){this._prerender=t}get onload(){return this._onload}set onload(t){this._onload=t}move(t){var e;t.preventDefault(),e=t.targetTouches?t.targetTouches[0].clientX:t.clientX;var n=this.getBoundingClientRect(),s=(e-n.left)/n.width;this.frame=Math.round((this._frames.length-1)*s)}load(t){this._reset(),this.dispatchEvent(new CustomEvent("gif-loading",{bubbles:!0,composed:!0,detail:t})),this._spinner.style.display="block";fetch(t,{method:"GET",mode:"cors",cache:"default"}).then((t=>t.arrayBuffer())).then((t=>new Uint8Array(t))).then((t=>new j(t))).then((t=>this.process(t))).then((()=>this._spinner.style.display="none"))}process(t){this._gif=t,this._canvas.width=t.width,this._canvas.height=t.height;var e=t.width/t.height,n=this.clientWidth/this.clientHeight;switch(this._canvas.style.top=0,this._canvas.style.left=0,this._size){case"auto":this.style.width=t.width+"px",this.style.height=t.height+"px";break;case"cover":e>n?(s=this.clientHeight*e,i=this.clientHeight,this._canvas.style.top=0,this._canvas.style.left=-(s-this.clientWidth)/2+"px"):(s=this.clientWidth,i=this.clientWidth/e,this._canvas.style.top=-(i-this.clientHeight)/2+"px",this._canvas.style.left=0),this._canvas.style.width=s+"px",this._canvas.style.height=i+"px";break;case"contain":var s,i;e>n?(s=this.clientWidth,i=this.clientWidth/e,this._canvas.style.top=(this.clientHeight-i)/2+"px",this._canvas.style.left=0):(s=this.clientHeight*e,i=this.clientHeight,this._canvas.style.top=0,this._canvas.style.left=(this.clientWidth-s)/2+"px"),this._canvas.style.width=s+"px",this._canvas.style.height=i+"px";break;case"stretch":this._canvas.style.width="100%",this._canvas.style.height="100%"}var r=t.numFrames();this._decoded=-1,this._delays=new Array(r),this._frames=new Array(r),this._frame<0&&(this._frame=this._frames.length+this._frame);var a=new CustomEvent("gif-loaded",{bubbles:!0,composed:!0,detail:t});this.dispatchEvent(a),this._onload&&this._onload(a),this._play?this.start():this.displayFrame(this._frames,this._frame),this._prerender&&requestIdleCallback(this.prerenderFramesBound)}start(){this.playing=!0,this.playAnimation(this._frames,this._frame)}stop(){this.playing=!1}pausePlayback(t){this.paused=!0}resumePlayback(t){this.paused=!1,this.playing&&this.playAnimation(this._frames,this._frame)}playLoop(t){this.rafHandle=requestAnimationFrame(this.playLoopBound),this._rendered!=this._frame&&this._frames[this._frame]&&(this._rendered=this._frame,this._ctx.putImageData(this._frames[this._frame],0,0))}playAnimation(t,e){0!==t.length&&(this.renderFrame(e),setTimeout((()=>{if(!this.paused){var t=this.frame+this._direction;t<0?this._bounce?(this._direction=1,t=1):t=this._frames.length-1:t>=this._frames.length&&(this._bounce?(this._direction=-1,t=this._frames.length-2):t=0),this.frame=t,this.playAnimation(this._frames,this._frame)}}),this._delays[e]*(1/this._speed)))}next(){this.frame++,this.frame>=this._frames.length&&(this.frame=0),this.render(this.frame)}displayFrame(t,e){0!==t.length&&(e>=t.length&&(e=t.length-1),e<0&&(e+=t.length),this.renderFrame(e),this._rendered!=e&&requestAnimationFrame((()=>{this._ctx.putImageData(this._frames[e],0,0),this._rendered=e,this.dispatchEvent(new CustomEvent("gif-frame",{bubbles:!0,composed:!0,detail:e}))})))}renderFrame(t){for(;this._decoded<t;){var e=this._decoded+1,n=this._gif.frameInfo(e),s=this._ctx.createImageData(this._gif.width,this._gif.height);e>0&&n.disposal<2&&s.data.set(new Uint8ClampedArray(this._frames[e-1].data)),this._gif.decodeAndBlitFrameRGBA(e,s.data),this._frames[e]=s,this._delays[e]=10*n.delay,this._decoded=e}}prerenderFrames(t){for(;t.timeRemaining()>0&&this._decoded<this._frames.length-1;)this.renderFrame(this._decoded+1);this._decoded<this._frames.length-1&&requestIdleCallback(this.prerenderBound)}}console.log("trigger player"),window.customElements.define("gif-player",e)}();return new class extends H{constructor(t){super(),q(this,t,O,U,r,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
