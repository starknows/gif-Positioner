var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function s(t){t.forEach(e)}function i(t){return"function"==typeof t}function r(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let a,o;function l(t,e){return a||(a=document.createElement("a")),a.href=e,t===a.href}function c(t){return null==t?"":t}function h(t,e){t.appendChild(e)}function d(t,e,n){t.insertBefore(e,n||null)}function u(t){t.parentNode&&t.parentNode.removeChild(t)}function p(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function f(t){return document.createElement(t)}function m(){return t=" ",document.createTextNode(t);var t}function g(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function v(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function _(t,e,n){e in t?t[e]="boolean"==typeof t[e]&&""===n||n:v(t,e,n)}function y(t){o=t}const b=[],x=[],w=[],k=[],$=Promise.resolve();let E=!1;function B(t){w.push(t)}const F=new Set;let L=0;function C(){const t=o;do{for(;L<b.length;){const t=b[L];L++,y(t),A(t.$$)}for(y(null),b.length=0,L=0;x.length;)x.pop()();for(let t=0;t<w.length;t+=1){const e=w[t];F.has(e)||(F.add(e),e())}w.length=0}while(b.length);for(;k.length;)k.pop()();E=!1,F.clear(),y(t)}function A(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(B)}}const I=new Set;function P(t,e){-1===t.$$.dirty[0]&&(b.push(t),E||(E=!0,$.then(C)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function q(r,a,l,c,h,d,p,f=[-1]){const m=o;y(r);const g=r.$$={fragment:null,ctx:[],props:d,update:t,not_equal:h,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(a.context||(m?m.$$.context:[])),callbacks:n(),dirty:f,skip_bound:!1,root:a.target||m.$$.root};p&&p(g.root);let v=!1;if(g.ctx=l?l(r,a.props||{},((t,e,...n)=>{const s=n.length?n[0]:e;return g.ctx&&h(g.ctx[t],g.ctx[t]=s)&&(!g.skip_bound&&g.bound[t]&&g.bound[t](s),v&&P(r,t)),e})):[],g.update(),v=!0,s(g.before_update),g.fragment=!!c&&c(g.ctx),a.target){if(a.hydrate){const t=function(t){return Array.from(t.childNodes)}(a.target);g.fragment&&g.fragment.l(t),t.forEach(u)}else g.fragment&&g.fragment.c();a.intro&&((_=r.$$.fragment)&&_.i&&(I.delete(_),_.i(b))),function(t,n,r,a){const{fragment:o,after_update:l}=t.$$;o&&o.m(n,r),a||B((()=>{const n=t.$$.on_mount.map(e).filter(i);t.$$.on_destroy?t.$$.on_destroy.push(...n):s(n),t.$$.on_mount=[]})),l.forEach(B)}(r,a.target,a.anchor,a.customElement),C()}var _,b;y(m)}class H{$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=t}$on(e,n){if(!i(n))return t;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(n),()=>{const t=s.indexOf(n);-1!==t&&s.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function M(t,e,n){const s=t.slice();return s[24]=e[n],s[26]=n,s}function z(t,e,n){const s=t.slice();return s[24]=e[n],s[26]=n,s}function R(t){let e,n,i,r,a,o,l,c,_,y,b,x=t[2],w=[];for(let e=0;e<x.length;e+=1)w[e]=T(M(t,x,e));return{c(){e=f("div"),n=f("div"),i=m(),r=f("div"),a=m(),o=f("div"),l=m(),c=f("div"),_=m();for(let t=0;t<w.length;t+=1)w[t].c();v(n,"class","back-to-setting left top svelte-xrtn6o"),v(r,"class","back-to-setting left bottom svelte-xrtn6o"),v(o,"class","back-to-setting right top svelte-xrtn6o"),v(c,"class","back-to-setting right bottom svelte-xrtn6o"),v(e,"class","stage-wrapper svelte-xrtn6o")},m(s,u){d(s,e,u),h(e,n),h(e,i),h(e,r),h(e,a),h(e,o),h(e,l),h(e,c),h(e,_);for(let t=0;t<w.length;t+=1)w[t].m(e,null);y||(b=[g(n,"click",t[16]),g(n,"keypress",t[17]),g(r,"click",t[18]),g(r,"keypress",t[19]),g(o,"click",t[20]),g(o,"keypress",t[21]),g(c,"click",t[22]),g(c,"keypress",t[23])],y=!0)},p(t,n){if(13&n){let s;for(x=t[2],s=0;s<x.length;s+=1){const i=M(t,x,s);w[s]?w[s].p(i,n):(w[s]=T(i),w[s].c(),w[s].m(e,null))}for(;s<w.length;s+=1)w[s].d(1);w.length=x.length}},d(t){t&&u(e),p(w,t),y=!1,s(b)}}}function S(t){let e,n,i,r,a,o,l,_,y,b,x,w,k,$,E,B,F,L,C,A,I,P,q,H,M,R,S,T,j,X;function J(t,e){return t[0]?G:W}let Y=J(t),K=Y(t);function Q(t,e){return t[4]?U:N}let V=Q(t),Z=V(t),tt=t[2],et=[];for(let e=0;e<tt.length;e+=1)et[e]=O(z(t,tt,e));return{c(){e=f("div"),n=f("div"),i=f("input"),r=m(),a=f("div"),K.c(),o=m(),l=f("div"),_=f("label"),_.textContent="BPM：",y=m(),b=f("input"),x=m(),w=f("button"),w.innerHTML='<span class="button-82-shadow"></span> \n          <span class="button-82-edge"></span> \n          <span class="button-82-front text">開始你的表演</span>',k=m(),$=f("span"),$.textContent="tip: 表演狀態時，點擊畫面四角即可返回",E=m(),B=f("span"),B.textContent="tip2: 建議使用 1秒1完整動作 的GIF",F=m(),L=f("div"),L.innerHTML="<span>Author: starknows</span> \n          <span>starknows99@gmail.com</span>",C=m(),A=f("div"),I=f("div"),P=f("button"),P.innerHTML='<span class="material-symbols-outlined">library_add</span> 新增區塊',q=m(),H=f("button"),H.innerHTML='<span class="material-symbols-outlined">delete</span> 清除區塊',M=m(),R=f("button"),Z.c(),S=m();for(let t=0;t<et.length;t+=1)et[t].c();v(i,"type","file"),v(i,"id","selectGif"),v(i,"accept","image/gif"),v(i,"class","svelte-xrtn6o"),v(a,"class","preview-window flex-center svelte-xrtn6o"),v(_,"for","input-bpm"),v(b,"id","input-bpm"),v(b,"type","number"),b.value=t[3],v(b,"min","60"),v(b,"max","240"),v(b,"class","svelte-xrtn6o"),v(l,"class","bpm-wrapper flex-center svelte-xrtn6o"),v(w,"class","button-82-pushable svelte-xrtn6o"),v($,"class","tip svelte-xrtn6o"),v(B,"class","tip svelte-xrtn6o"),v(L,"class","author-wrapper flex-center flex-col svelte-xrtn6o"),v(n,"class","control-area card flex-center flex-col svelte-xrtn6o"),v(e,"class","control-wrapper flex-center flex-col space-between svelte-xrtn6o"),v(P,"class","flex-center svelte-xrtn6o"),v(H,"class","flex-center svelte-xrtn6o"),v(R,"class","flex-center svelte-xrtn6o"),v(I,"class","add-item flex-center svelte-xrtn6o"),v(A,"id","setting-wrapper"),v(A,"class",T=c("layout-setting "+(t[4]?"preview":"card"))+" svelte-xrtn6o")},m(s,c){d(s,e,c),h(e,n),h(n,i),h(n,r),h(n,a),K.m(a,null),h(n,o),h(n,l),h(l,_),h(l,y),h(l,b),h(n,x),h(n,w),h(n,k),h(n,$),h(n,E),h(n,B),h(n,F),h(n,L),d(s,C,c),d(s,A,c),h(A,I),h(I,P),h(I,q),h(I,H),h(I,M),h(I,R),Z.m(R,null),h(A,S);for(let t=0;t<et.length;t+=1)et[t].m(A,null);j||(X=[g(i,"change",t[5]),g(a,"click",D),g(b,"input",t[11]),g(w,"click",t[9]),g(P,"click",t[6]),g(H,"click",t[12]),g(R,"click",t[10])],j=!0)},p(t,e){if(Y===(Y=J(t))&&K?K.p(t,e):(K.d(1),K=Y(t),K&&(K.c(),K.m(a,null))),8&e&&b.value!==t[3]&&(b.value=t[3]),V!==(V=Q(t))&&(Z.d(1),Z=V(t),Z&&(Z.c(),Z.m(R,null))),388&e){let n;for(tt=t[2],n=0;n<tt.length;n+=1){const s=z(t,tt,n);et[n]?et[n].p(s,e):(et[n]=O(s),et[n].c(),et[n].m(A,null))}for(;n<et.length;n+=1)et[n].d(1);et.length=tt.length}16&e&&T!==(T=c("layout-setting "+(t[4]?"preview":"card"))+" svelte-xrtn6o")&&v(A,"class",T)},d(t){t&&u(e),K.d(),t&&u(C),t&&u(A),Z.d(),p(et,t),j=!1,s(X)}}}function T(t){let e,n,s,i,r,a;return{c(){e=f("div"),n=f("gif-player"),r=m(),l(n.src,s=t[0])||_(n,"src",s),_(n,"speed",i=t[3]/60),_(n,"size","contain"),_(n,"play",""),_(n,"class","svelte-xrtn6o"),v(e,"class","render-unit svelte-xrtn6o"),v(e,"style",a=`width:${t[24].width}%;left:${t[24].left}%;top:${t[24].top}%;`)},m(t,s){d(t,e,s),h(e,n),h(e,r)},p(t,r){1&r&&!l(n.src,s=t[0])&&_(n,"src",s),8&r&&i!==(i=t[3]/60)&&_(n,"speed",i),4&r&&a!==(a=`width:${t[24].width}%;left:${t[24].left}%;top:${t[24].top}%;`)&&v(e,"style",a)},d(t){t&&u(e)}}}function W(e){let n;return{c(){n=f("span"),n.textContent="選擇圖片"},m(t,e){d(t,n,e)},p:t,d(t){t&&u(n)}}}function G(t){let e,n;return{c(){e=f("img"),l(e.src,n=t[0])||v(e,"src",n),v(e,"alt",""),v(e,"class","svelte-xrtn6o")},m(t,n){d(t,e,n)},p(t,s){1&s&&!l(e.src,n=t[0])&&v(e,"src",n)},d(t){t&&u(e)}}}function N(t){let e,n,s;return{c(){e=f("span"),e.textContent="open_with",n=m(),s=f("span"),s.textContent=" 全螢幕",v(e,"class","material-symbols-outlined")},m(t,i){d(t,e,i),d(t,n,i),d(t,s,i)},d(t){t&&u(e),t&&u(n),t&&u(s)}}}function U(t){let e,n,s;return{c(){e=f("span"),e.textContent="close_fullscreen",n=m(),s=f("span"),s.textContent=" 關閉",v(e,"class","material-symbols-outlined")},m(t,i){d(t,e,i),d(t,n,i),d(t,s,i)},d(t){t&&u(e),t&&u(n),t&&u(s)}}}function O(t){let e,n,i,r,a,o,l,c,p,_,y;function b(...e){return t[13](t[26],...e)}function x(...e){return t[14](t[26],...e)}function w(...e){return t[15](t[26],...e)}return{c(){e=f("div"),n=f("span"),n.textContent="close",i=m(),r=f("div"),a=f("span"),a.textContent="add",o=m(),l=f("span"),l.textContent="remove",c=m(),v(n,"class","material-symbols-outlined icon-close svelte-xrtn6o"),v(a,"class","material-symbols-outlined svelte-xrtn6o"),v(l,"class","material-symbols-outlined svelte-xrtn6o"),v(r,"class","scale-icon-wrapper flex-center flex-col svelte-xrtn6o"),v(e,"class","item-unit svelte-xrtn6o"),v(e,"style",p=`width:${t[24].width}%;left:${t[24].left}%;top:${t[24].top}%;`),v(e,"data-index",t[26])},m(s,u){d(s,e,u),h(e,n),h(e,i),h(e,r),h(r,a),h(r,o),h(r,l),h(e,c),_||(y=[g(n,"click",b),g(a,"click",x),g(l,"click",w),g(e,"mousedown",t[7])],_=!0)},p(n,s){t=n,4&s&&p!==(p=`width:${t[24].width}%;left:${t[24].left}%;top:${t[24].top}%;`)&&v(e,"style",p)},d(t){t&&u(e),_=!1,s(y)}}}function j(e){let n;function s(t,e){return t[1]?R:S}let i=s(e),r=i(e);return{c(){n=f("main"),r.c(),v(n,"class","flex-center svelte-xrtn6o")},m(t,e){d(t,n,e),r.m(n,null)},p(t,[e]){i===(i=s(t))&&r?r.p(t,e):(r.d(1),r=i(t),r&&(r.c(),r.m(n,null)))},i:t,o:t,d(t){t&&u(n),r.d()}}}function D(){document.getElementById("selectGif").click()}function X(t,e,n){let s=null,i=!1,r=[],a=60,o=!1;function l(t,e,s){switch(console.log(e,s),t.stopPropagation(),e){case"plus":n(2,r[s].width+=2,r),n(2,r[s].height+=2,r),r[s].width>40&&n(2,r[s].width=40,r),r[s].height>40&&n(2,r[s].height=40,r);break;case"minus":n(2,r[s].width-=2,r),n(2,r[s].height-=2,r),r[s].width<7&&n(2,r[s].width=7,r),r[s].height<7&&n(2,r[s].height=7,r);break;case"remove":console.log("trigger"),r.splice(s,1),n(2,r=[...r])}}return[s,i,r,a,o,function(t){const[e]=t.target.files;e&&(n(0,s=URL.createObjectURL(e)),console.log(s))},function(){n(2,r=[...r,{top:0,left:0,width:10,height:10,layer:null}])},function(t){t.stopPropagation();let e=t.target.dataset.index;if(!e)return;const s=t.target.parentElement.clientWidth,i=t.target.parentElement.clientHeight,a=JSON.parse(JSON.stringify(r[e])),o=a.left,l=a.top,c=t.clientX,h=t.clientY,d=Math.floor(a.width/s*1e3)/10,u=Math.floor(a.height/i*1e3)/10;document.onmousemove=t=>{const a=Math.floor((t.clientX-c)/s*1e3)/10,p=Math.floor((t.clientY-h)/i*1e3)/10;n(2,r[e].left=o+a,r),n(2,r[e].top=l+p,r),r[e].left+d>100&&n(2,r[e].left=100-d,r),r[e].left<0&&n(2,r[e].left=0,r),r[e].top+u>100&&n(2,r[e].top=100-u,r),r[e].top<0&&n(2,r[e].top=0,r)};let p=()=>{document.onmousemove=null,document.removeEventListener("mouseup",p)};document.addEventListener("mouseup",p)},l,function(){s?r.length<1?alert("請新增GIF區塊!"):n(1,i=!0):alert("請上傳GIF!")},function(){if(o)document.exitFullscreen();else{let t=document.getElementById("setting-wrapper");t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()}n(4,o=!o)},t=>n(3,a=t.target.value),()=>n(2,r=[]),(t,e)=>l(e,"remove",t),(t,e)=>l(e,"plus",t),(t,e)=>l(e,"minus",t),()=>n(1,i=!1),()=>n(1,i=!1),()=>n(1,i=!1),()=>n(1,i=!1),()=>n(1,i=!1),()=>n(1,i=!1),()=>n(1,i=!1),()=>n(1,i=!1)]}function J(t){var e=0;if(71!==t[e++]||73!==t[e++]||70!==t[e++]||56!==t[e++]||56!=(t[e++]+1&253)||97!==t[e++])throw"Invalid GIF 87a/89a header.";var n=t[e++]|t[e++]<<8,s=t[e++]|t[e++]<<8,i=t[e++],r=i>>7,a=1<<(7&i)+1;t[e++],t[e++];var o=null;r&&(o=e,e+=3*a);var l=!0,c=[],h=0,d=null,u=0,p=null;for(this.width=n,this.height=s;l&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(11!==t[e]||78==t[e+1]&&69==t[e+2]&&84==t[e+3]&&83==t[e+4]&&67==t[e+5]&&65==t[e+6]&&80==t[e+7]&&69==t[e+8]&&50==t[e+9]&&46==t[e+10]&&48==t[e+11]&&3==t[e+12]&&1==t[e+13]&&0==t[e+16])e+=14,p=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(0===($=t[e++]))break;e+=$}break;case 249:if(4!==t[e++]||0!==t[e+4])throw"Invalid graphics extension block.";var f=t[e++];h=t[e++]|t[e++]<<8,d=t[e++],0==(1&f)&&(d=null),u=f>>2&7,e++;break;case 254:for(;;){if(0===($=t[e++]))break;e+=$}break;default:throw"Unknown graphic control label: 0x"+t[e-1].toString(16)}break;case 44:var m=t[e++]|t[e++]<<8,g=t[e++]|t[e++]<<8,v=t[e++]|t[e++]<<8,_=t[e++]|t[e++]<<8,y=t[e++],b=y>>6&1,x=o,w=!1;if(y>>7){w=!0;x=e,e+=3*(1<<(7&y)+1)}var k=e;for(e++;;){var $;if(0===($=t[e++]))break;e+=$}c.push({x:m,y:g,width:v,height:_,has_local_palette:w,palette_offset:x,data_offset:k,data_length:e-k,transparent_index:d,interlaced:!!b,delay:h,disposal:u});break;case 59:l=!1;break;default:throw"Unknown gif block: 0x"+t[e-1].toString(16)}this.numFrames=function(){return c.length},this.loopCount=function(){return p},this.frameInfo=function(t){if(t<0||t>=c.length)throw"Frame index out of range.";return c[t]},this.decodeAndBlitFrameRGBA=function(e,s){var i=this.frameInfo(e),r=i.width*i.height,a=new Uint8Array(r);!function(t,e,n,s){var i=t[e++],r=1<<i,a=r+1,o=a+1,l=i+1,c=(1<<l)-1,h=0,d=0,u=0,p=t[e++],f=new Int32Array(4096),m=null;for(;;){for(;h<16&&0!==p;)d|=t[e++]<<h,h+=8,1===p?p=t[e++]:--p;if(h<l)break;var g=d&c;if(d>>=l,h-=l,g!==r){if(g===a)break;for(var v=g<o?g:m,_=0,y=v;y>r;)y=f[y]>>8,++_;var b=y;if(u+_+(v!==g?1:0)>s)return void console.log("Warning, gif stream longer than expected.");n[u++]=b;var x=u+=_;for(v!==g&&(n[u++]=b),y=v;_--;)y=f[y],n[--x]=255&y,y>>=8;null!==m&&o<4096&&(f[o++]=m<<8|b,o>=c+1&&l<12&&(++l,c=c<<1|1)),m=g}else o=a+1,c=(1<<(l=i+1))-1,m=null}u!==s&&console.log("Warning, gif stream shorter than expected.")}(t,i.data_offset,a,r);var o=i.palette_offset,l=i.transparent_index;null===l&&(l=256);var c=i.width,h=n-c,d=c,u=4*(i.y*n+i.x),p=4*((i.y+i.height)*n+i.x),f=u,m=4*h;!0===i.interlaced&&(m+=4*n*7);for(var g=8,v=0,_=a.length;v<_;++v){var y=a[v];if(0===d&&(d=c,(f+=m)>=p&&(m=4*h+4*n*(g-1),f=u+(c+h)*(g<<1),g>>=1)),y===l)f+=4;else{var b=t[o+3*y],x=t[o+3*y+1],w=t[o+3*y+2];s[f++]=b,s[f++]=x,s[f++]=w,s[f++]=255}--d}}}!function(){const t=document.createElement("template");t.innerHTML="\n<style>\n  canvas {\n    position: absolute;\n  }\n\n  @keyframes spinner {\n    to {transform: rotate(360deg);}\n  }\n\n  .spinner:before {\n    content: '';\n    box-sizing: border-box;\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    width: 20px;\n    height: 20px;\n    margin-top: -10px;\n    margin-left: -10px;\n    border-radius: 50%;\n    border-top: 2px solid #999;\n    border-right: 2px solid transparent;\n    animation: spinner .6s linear infinite;\n  }\n</style>\n<canvas></canvas>\n<div class=\"spinner\"></spinner>\n";class e extends HTMLElement{static get observedAttributes(){return["src","frame","size","speed","play","swipe","repeat","bounce","direction"]}constructor(){super(),this._speed=.5,this._size="auto",this._swipe=!0,this._repeat=!0,this._bounce=!1,this._prerender=!1,this._direction=1,this._reset(),this.pausePlaybackBound=this.pausePlayback.bind(this),this.moveBound=this.move.bind(this),this.resumePlaybackBound=this.resumePlayback.bind(this),this.prerenderFramesBound=this.prerenderFrames.bind(this),this.playLoopBound=this.playLoop.bind(this);const e=this.attachShadow({mode:"open"});e.appendChild(document.importNode(t.content,!0)),this._spinner=e.querySelector(".spinner"),this._canvas=e.querySelector("canvas"),this._ctx=this._canvas.getContext("2d")}connectedCallback(){this.style.display="inline-block",this.style.position="relative",this.style.overflow="hidden",this.style.cursor="col-resize",this.addEventListener("touchstart",this.pausePlaybackBound,!1),this.addEventListener("touchmove",this.moveBound,!1),this.addEventListener("touchend",this.resumePlaybackBound,!1),this.addEventListener("mouseenter",this.pausePlaybackBound,!1),this.addEventListener("mousemove",this.moveBound,!1),this.addEventListener("mouseleave",this.resumePlaybackBound,!1)}disconnectedCallback(){this.removeEventListener("touchstart",this.pausePlaybackBound,!1),this.removeEventListener("touchmove",this.moveBound,!1),this.removeEventListener("touchend",this.resumePlaybackBound,!1),this.removeEventListener("mouseenter",this.pausePlaybackBound,!1),this.removeEventListener("mousemove",this.moveBound,!1),this.removeEventListener("mouseleave",this.resumePlaybackBound,!1)}attributeChangedCallback(t,e,n){e!==n&&(this[t]=n)}_reset(){this._frames=[],this._delays=[],this._frame=0,this._decoded=-1,this._rendered=-1}_handleBoolean(t,e){this["_"+t]=e=null!=e,e?this.setAttribute(t,""):this.removeAttribute(t)}get src(){return this._src}set src(t){this._src=t,this.load(t)}get frame(){return this._frame}set frame(t){this._frame=parseInt(t),this.displayFrame(this._frames,this._frame)}get size(){return this._size}set size(t){this._size=t}get speed(){return this._speed}set speed(t){this._speed=parseFloat(t)}get swipe(){return this._swipe}set swipe(t){this._swipe=t}get play(){return this._play}set play(t){this._handleBoolean("play",t)}get repeat(){return this._repeat}set repeat(t){this._repeat=parseFloat(t)}get bounce(){return this._bounce}set bounce(t){this._handleBoolean("bounce",t)}get direction(){return this._direction}set direction(t){this._direction=parseInt(t)}get prerender(){return this._prerender}set prerender(t){this._prerender=t}get onload(){return this._onload}set onload(t){this._onload=t}move(t){var e;t.preventDefault(),e=t.targetTouches?t.targetTouches[0].clientX:t.clientX;var n=this.getBoundingClientRect(),s=(e-n.left)/n.width;this.frame=Math.round((this._frames.length-1)*s)}load(t){this._reset(),this.dispatchEvent(new CustomEvent("gif-loading",{bubbles:!0,composed:!0,detail:t})),this._spinner.style.display="block";fetch(t,{method:"GET",mode:"cors",cache:"default"}).then((t=>t.arrayBuffer())).then((t=>new Uint8Array(t))).then((t=>new J(t))).then((t=>this.process(t))).then((()=>this._spinner.style.display="none"))}process(t){this._gif=t,this._canvas.width=t.width,this._canvas.height=t.height;var e=t.width/t.height,n=this.clientWidth/this.clientHeight;switch(this._canvas.style.top=0,this._canvas.style.left=0,this._size){case"auto":this.style.width=t.width+"px",this.style.height=t.height+"px";break;case"cover":e>n?(s=this.clientHeight*e,i=this.clientHeight,this._canvas.style.top=0,this._canvas.style.left=-(s-this.clientWidth)/2+"px"):(s=this.clientWidth,i=this.clientWidth/e,this._canvas.style.top=-(i-this.clientHeight)/2+"px",this._canvas.style.left=0),this._canvas.style.width=s+"px",this._canvas.style.height=i+"px";break;case"contain":var s,i;e>n?(s=this.clientWidth,i=this.clientWidth/e,this._canvas.style.top=(this.clientHeight-i)/2+"px",this._canvas.style.left=0):(s=this.clientHeight*e,i=this.clientHeight,this._canvas.style.top=0,this._canvas.style.left=(this.clientWidth-s)/2+"px"),this._canvas.style.width=s+"px",this._canvas.style.height=i+"px";break;case"stretch":this._canvas.style.width="100%",this._canvas.style.height="100%"}var r=t.numFrames();this._decoded=-1,this._delays=new Array(r),this._frames=new Array(r),this._frame<0&&(this._frame=this._frames.length+this._frame);var a=new CustomEvent("gif-loaded",{bubbles:!0,composed:!0,detail:t});this.dispatchEvent(a),this._onload&&this._onload(a),this._play?this.start():this.displayFrame(this._frames,this._frame),this._prerender&&requestIdleCallback(this.prerenderFramesBound)}start(){this.playing=!0,this.playAnimation(this._frames,this._frame)}stop(){this.playing=!1}pausePlayback(t){this.paused=!0}resumePlayback(t){this.paused=!1,this.playing&&this.playAnimation(this._frames,this._frame)}playLoop(t){this.rafHandle=requestAnimationFrame(this.playLoopBound),this._rendered!=this._frame&&this._frames[this._frame]&&(this._rendered=this._frame,this._ctx.putImageData(this._frames[this._frame],0,0))}playAnimation(t,e){0!==t.length&&(this.renderFrame(e),setTimeout((()=>{if(!this.paused){var t=this.frame+this._direction;t<0?this._bounce?(this._direction=1,t=1):t=this._frames.length-1:t>=this._frames.length&&(this._bounce?(this._direction=-1,t=this._frames.length-2):t=0),this.frame=t,this.playAnimation(this._frames,this._frame)}}),this._delays[e]*(1/this._speed)))}next(){this.frame++,this.frame>=this._frames.length&&(this.frame=0),this.render(this.frame)}displayFrame(t,e){0!==t.length&&(e>=t.length&&(e=t.length-1),e<0&&(e+=t.length),this.renderFrame(e),this._rendered!=e&&requestAnimationFrame((()=>{this._ctx.putImageData(this._frames[e],0,0),this._rendered=e,this.dispatchEvent(new CustomEvent("gif-frame",{bubbles:!0,composed:!0,detail:e}))})))}renderFrame(t){for(;this._decoded<t;){var e=this._decoded+1,n=this._gif.frameInfo(e),s=this._ctx.createImageData(this._gif.width,this._gif.height);e>0&&n.disposal<2&&s.data.set(new Uint8ClampedArray(this._frames[e-1].data)),this._gif.decodeAndBlitFrameRGBA(e,s.data),this._frames[e]=s,this._delays[e]=10*n.delay,this._decoded=e}}prerenderFrames(t){for(;t.timeRemaining()>0&&this._decoded<this._frames.length-1;)this.renderFrame(this._decoded+1);this._decoded<this._frames.length-1&&requestIdleCallback(this.prerenderBound)}}console.log("trigger player"),window.customElements.define("gif-player",e)}();return new class extends H{constructor(t){super(),q(this,t,X,j,r,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
